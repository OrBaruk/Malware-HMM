#!/bin/bash

files=("Trojan.Agent" "Trojan.Agent" "Trojan.Bifrose" "Trojan.Buzus"
"Trojan.Downloader" "Trojan.FakeSSH" "Trojan.IRCBot" "Trojan.Lolbot"
"Trojan.Neopoe" "Trojan.Pincav" "Trojan.Renos" "Trojan.SdBot" "Trojan.Small"
"Trojan.Spy"  "UNKNOWN" "W32.Virut" "Worm.Agent" "Worm.Allaple" "Worm.Autorun"
"Worm.Bybz" "Worm.Palevo" "Worm.Peda" "dedler" "heolag" "tibbs")
encoder=./bin/encoder
mfa2long=./bin/mfa2long
logs_train=./data/train/logs
logs_test=./data/test/logs
sequences_train=./data/train/sequences
sequences_test=./data/test/sequences
alignment_train=./data/train/alignment
alignment_test=./data/test/alignment
long_train=./data/train/alignment/long
long_test=./data/test/alignment/long


# buildproject

# encode files
for file in "${files[@]}"
do
  echo "======================== $file ========================"
  # Trainning Data
  $encoder $logs_train/$file* > $sequences_train/$file.fa
  # Test Data
  # $encoder $logs_test/$file* > $sequences_test/$file.fa

  # run mafft
  mafft --auto --text $sequences_train/$file.fa > $alignment_train/$file.mfa
  # mafft --auto --text $sequences_test/$file.fa > $alignment_test/$file.mfa

  # convert to long format
  $mfa2long $alignment_train/$file.mfa > $long_train/$file.long
  # $mfa2long $alignment_test/$file.mfa > $long_test/$file.long
done

$encoder $logs_train/* > $sequences_train/All.fa
# $encoder $logs_test/* > $sequences_test/All.fa

# run hmmbuild
# run hmmsearch
