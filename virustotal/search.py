import json
import requests
import time


def main():
	url =  'https://www.virustotal.com/vtapi/v2/file/report'
	apikey = '2e5bc3f93fe60277edb9db8d7c14909cf38db8ce4d7118d73105cde60e5ef31b'

	f = open('hashes.txt', 'r')

	counter = 1
	for line in f:
		resource = line.split()[8]
		parameters = {
			'resource': resource,
			'apikey':apikey

		}
		r = requests.get(url, params=parameters)

		# Save result to file
		o = open('json/'+resource+'.json', 'w')
		o.write(r.text+'\n')
		o.close()

		# Wait for virustotal api limit
		print(str(counter)+' >> '+resource)
		time.sleep(15)
		counter += 1

	return

if __name__ == "__main__":
    main()