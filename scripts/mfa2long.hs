import Data.List.Split
import System.Environment
import System.FilePath

main :: IO()
main = getArgs >>= parseArgs

parseArgs :: [String] -> IO()
parseArgs (h:t) = parseFile h >> parseArgs t
parseArgs _ = return ()

parseFile :: FilePath -> IO()
parseFile fp = readFile fp >>= putStr . parse

parse :: String -> String
parse l = foldl (\x y-> x++"\n"++y) "" (map removeNl (splitOn ">" l))

removeNl :: String -> String
removeNl l = foldl (++) "" (tail (splitOn "\n" l))
